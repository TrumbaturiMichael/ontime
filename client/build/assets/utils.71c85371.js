import{r as _}from"./index.884ef809.js";const v=Symbol(),rt=i=>!!i[v],at=i=>!i[v].c,b=i=>{var f;const{b:u,c:d}=i[v];d&&(d(),(f=pt.get(u))==null||f())},C=(i,f)=>{const u=i[v].o,d=f[v].o;return u===d||i===d||rt(u)&&C(u,f)},nt=(i,f)=>{const u={b:i,o:f,c:null},d=new Promise(l=>{u.c=()=>{u.c=null,l()},f.finally(u.c)});return d[v]=u,d},pt=new WeakMap,I=i=>"init"in i,G="r",F="w",U="c",J="s",ot="h",Et="n",St="l",mt="a",At="m",wt=i=>{const f=new WeakMap,u=new WeakMap,d=new Map;let l,E;if(({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&(l=new Set,E=new Set),i)for(const[e,t]of i){const n={v:t,r:0,y:!0,d:new Map};({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&(Object.freeze(n),I(e)||console.warn("Found initial value for derived atom which can cause unexpected behavior",e)),f.set(e,n)}const a=new WeakMap,S=(e,t,n)=>{let r=a.get(t);r||(r=new Map,a.set(t,r)),n.then(()=>{r.get(e)===n&&(r.delete(e),r.size||a.delete(t))}),r.set(e,n)},h=e=>{const t=new Set,n=a.get(e);return n&&(a.delete(e),n.forEach((r,o)=>{b(r),t.add(o)})),t},M=new WeakMap,D=e=>{let t=M.get(e);return t||(t=new Map,M.set(e,t)),t},m=(e,t)=>{if(e){const n=D(e);let r=n.get(t);return r||(r=m(e.p,t),r&&n.set(t,r)),r}return f.get(t)},A=(e,t,n)=>{if(({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&Object.freeze(n),e)D(e).set(t,n);else{const r=f.get(t);f.set(t,n),d.has(t)||d.set(t,r)}},w=(e,t=new Map,n)=>{if(!n)return t;const r=new Map;let o=!1;return n.forEach(s=>{var c;const p=((c=m(e,s))==null?void 0:c.r)||0;r.set(s,p),t.get(s)!==p&&(o=!0)}),t.size===r.size&&!o?t:r},P=(e,t,n,r,o)=>{const s=m(e,t);if(s){if(o&&(!("p"in s)||!C(s.p,o)))return s;"p"in s&&b(s.p)}const c={v:n,r:(s==null?void 0:s.r)||0,y:!0,d:w(e,s==null?void 0:s.d,r)};let p=!(s!=null&&s.y);return!s||!("v"in s)||!Object.is(s.v,n)?(p=!0,++c.r,c.d.has(t)&&(c.d=new Map(c.d).set(t,c.r))):c.d!==s.d&&(c.d.size!==s.d.size||!Array.from(c.d.keys()).every(g=>s.d.has(g)))&&(p=!0,Promise.resolve().then(()=>{R(e)})),s&&!p?s:(A(e,t,c),c)},q=(e,t,n,r,o)=>{const s=m(e,t);if(s){if(o&&(!("p"in s)||!C(s.p,o)))return s;"p"in s&&b(s.p)}const c={e:n,r:((s==null?void 0:s.r)||0)+1,y:!0,d:w(e,s==null?void 0:s.d,r)};return A(e,t,c),c},H=(e,t,n,r)=>{const o=m(e,t);if(o&&"p"in o){if(C(o.p,n))return o.y?o:{...o,y:!0};b(o.p)}S(e,t,n);const s={p:n,r:((o==null?void 0:o.r)||0)+1,y:!0,d:w(e,o==null?void 0:o.d,r)};return A(e,t,s),s},V=(e,t,n,r)=>{if(n instanceof Promise){const o=nt(n,n.then(s=>{P(e,t,s,r,o)}).catch(s=>{if(s instanceof Promise)return rt(s)?s.then(()=>{y(e,t,!0)}):s;q(e,t,s,r,o)}));return H(e,t,o,r)}return P(e,t,n,r)},it=(e,t)=>{const n=m(e,t);if(n){const r={...n,y:!1};A(e,t,r)}else({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&console.warn("[Bug] could not invalidate non existing atom",t)},y=(e,t,n)=>{if(!n){const o=m(e,t);if(o){if(o.y&&"p"in o&&!at(o.p))return o;if(o.d.forEach((s,c)=>{if(c!==t)if(!u.has(c))y(e,c);else{const p=m(e,c);p&&!p.y&&y(e,c)}}),Array.from(o.d).every(([s,c])=>{const p=m(e,s);return p&&!("p"in p)&&p.r===c}))return o.y?o:{...o,y:!0}}}const r=new Set;try{const o=t.read(s=>{r.add(s);const c=s===t?m(e,s):y(e,s);if(c){if("e"in c)throw c.e;if("p"in c)throw c.p;return c.v}if(I(s))return s.init;throw new Error("no atom init")});return V(e,t,o,r)}catch(o){if(o instanceof Promise){const s=nt(o,o);return H(e,t,s,r)}return q(e,t,o,r)}},K=(e,t)=>y(t,e),ct=(e,t)=>{let n=u.get(t);return n||(n=W(e,t)),n},B=(e,t)=>!t.l.size&&(!t.t.size||t.t.size===1&&t.t.has(e)),ut=(e,t)=>{const n=u.get(t);n&&B(t,n)&&k(e,t)},L=(e,t)=>{const n=u.get(t);n==null||n.t.forEach(r=>{r!==t&&(it(e,r),L(e,r))})},Q=(e,t,n)=>{let r=!0;const o=(p,g)=>{const O=y(e,p);if("e"in O)throw O.e;if("p"in O){if(g!=null&&g.unstable_promise)return O.p.then(()=>{const x=m(e,p);return x&&"p"in x&&x.p===O.p?new Promise(N=>setTimeout(N)).then(()=>o(p,g)):o(p,g)});throw({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&console.info("Reading pending atom state in write operation. We throw a promise for now.",p),O.p}if("v"in O)return O.v;throw({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&console.warn("[Bug] no value found while reading atom in write operation. This is probably a bug.",p),new Error("no value found")},s=(p,g)=>{let O;if(p===t){if(!I(p))throw new Error("atom not writable");h(p).forEach(et=>{et!==e&&V(et,p,g)});const N=m(e,p),lt=V(e,p,g);N!==lt&&L(e,p)}else O=Q(e,p,g);return r||R(e),O},c=t.write(o,s,n);return r=!1,c},z=(e,t,n)=>{const r=Q(n,e,t);return R(n),r},ft=e=>!!e.write,W=(e,t,n)=>{const r={t:new Set(n&&[n]),l:new Set};if(u.set(t,r),({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&E.add(t),y(void 0,t).d.forEach((s,c)=>{const p=u.get(c);p?p.t.add(t):c!==t&&W(e,c,t)}),ft(t)&&t.onMount){const s=p=>z(t,p,e),c=t.onMount(s);e=void 0,c&&(r.u=c)}return r},k=(e,t)=>{var n;const r=(n=u.get(t))==null?void 0:n.u;r&&r(),u.delete(t),({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&E.delete(t);const o=m(e,t);o?("p"in o&&b(o.p),o.d.forEach((s,c)=>{if(c!==t){const p=u.get(c);p&&(p.t.delete(t),B(c,p)&&k(e,c))}})):({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&console.warn("[Bug] could not find atom state to unmount",t)},X=(e,t,n,r)=>{const o=new Set(n.d.keys());r==null||r.forEach((s,c)=>{if(o.has(c)){o.delete(c);return}const p=u.get(c);p&&(p.t.delete(t),B(c,p)&&k(e,c))}),o.forEach(s=>{const c=u.get(s);c?c.t.add(t):u.has(t)&&W(e,s,t)})},R=e=>{if(e){D(e).forEach((n,r)=>{const o=f.get(r);if(n!==o){const s=u.get(r);s==null||s.l.forEach(c=>c(e))}});return}for(;d.size;){const t=Array.from(d);d.clear(),t.forEach(([n,r])=>{const o=m(void 0,n);if(o&&o.d!==(r==null?void 0:r.d)&&X(void 0,n,o,r==null?void 0:r.d),r&&!r.y&&(o==null?void 0:o.y))return;const s=u.get(n);s==null||s.l.forEach(c=>c())})}({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&l.forEach(t=>t())},dt=e=>{D(e).forEach((n,r)=>{const o=f.get(r);(!o||n.r>o.r||n.y!==o.y||n.r===o.r&&n.d!==o.d)&&(f.set(r,n),n.d!==(o==null?void 0:o.d)&&X(e,r,n,o==null?void 0:o.d))})},Y=(e,t)=>{t&&dt(t),R(void 0)},Z=(e,t,n)=>{const o=ct(n,e).l;return o.add(t),()=>{o.delete(t),ut(n,e)}},tt=(e,t)=>{for(const[n,r]of e)I(n)&&(V(t,n,r),L(t,n));R(t)};return({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"?{[G]:K,[F]:z,[U]:Y,[J]:Z,[ot]:tt,[Et]:e=>(l.add(e),()=>{l.delete(e)}),[St]:()=>E.values(),[mt]:e=>f.get(e),[At]:e=>u.get(e)}:{[G]:K,[F]:z,[U]:Y,[J]:Z,[ot]:tt}},ht=(i,f)=>({s:f?f(i).SECRET_INTERNAL_store:wt(i)}),j=new Map,st=i=>(j.has(i)||j.set(i,_.exports.createContext(ht())),j.get(i));let Mt=0;function T(i,f){const u=`atom${++Mt}`,d={toString:()=>u};return typeof i=="function"?d.read=i:(d.init=i,d.read=l=>l(d),d.write=(l,E,a)=>E(d,typeof a=="function"?a(l(d)):a)),f&&(d.write=f),d}function Ot(i,f){const u=st(f),d=_.exports.useContext(u),{s:l,v:E}=d,a=A=>{const w=l[G](i,A);if(({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&!w.y)throw new Error("should not be invalidated");if("e"in w)throw w.e;if("p"in w)throw w.p;if("v"in w)return w.v;throw new Error("no atom value")},[[S,h,M],D]=_.exports.useReducer((A,w)=>{const P=a(w);return Object.is(A[1],P)&&A[2]===i?A:[w,P,i]},E,A=>{const w=a(A);return[A,w,i]});let m=h;return M!==i&&(D(S),m=a(S)),_.exports.useEffect(()=>{const{v:A}=d;A&&l[U](i,A);const w=l[J](i,D,A);return D(A),w},[l,i,d]),_.exports.useEffect(()=>{l[U](i,S)}),_.exports.useDebugValue(m),m}function gt(i,f){const u=st(f),{s:d,w:l}=_.exports.useContext(u);return _.exports.useCallback(a=>{if(({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&!("write"in i))throw new Error("not writable atom");const S=h=>d[F](i,a,h);return l?l(S):S()},[d,l,i])}function Vt(i,f){return"scope"in i&&(console.warn("atom.scope is deprecated. Please do useAtom(atom, scope) instead."),f=i.scope),[Ot(i,f),gt(i,f)]}const Dt=Symbol(),_t=(i,f)=>{do{const[u,...d]=f,l=i.get(u);if(!l)return;if(!d.length)return l[1];i=l[0],f=d}while(f.length)},yt=(i,f,u)=>{do{const[d,...l]=f;let E=i.get(d);if(E||(E=[new WeakMap],i.set(d,E)),!l.length){E[1]=u;return}i=E[0],f=l}while(f.length)},vt=()=>{const i=new WeakMap;return(u,d)=>{const l=_t(i,d);if(l)return l;const E=u();return yt(i,d,E),E}},Pt=vt();function xt(i,f,u=Object.is){return Pt(()=>{const d=T(()=>({}));return T(E=>{const a=f(E(i)),S=E(d);return"prev"in S&&u(S.prev,a)?S.prev:(S.prev=a,a)})},[i,f,u])}T(()=>[]);const $=Symbol();function Rt(i){let f,u;const d={getItem:l=>{var E,a;const S=M=>{if(M=M||"",f!==M){try{u=JSON.parse(M)}catch{return $}f=M}return u},h=(a=(E=i())==null?void 0:E.getItem(l))!=null?a:null;return h instanceof Promise?h.then(S):S(h)},setItem:(l,E)=>{var a;return(a=i())==null?void 0:a.setItem(l,JSON.stringify(E))},removeItem:l=>{var E;return(E=i())==null?void 0:E.removeItem(l)}};return typeof window<"u"&&typeof window.addEventListener=="function"&&(d.subscribe=(l,E)=>{const a=S=>{S.key===l&&S.newValue&&E(JSON.parse(S.newValue))};return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}}),d}const bt=Rt(()=>typeof window<"u"?window.localStorage:void 0);function It(i,f,u=bt){const d=()=>{const a=u.getItem(i);return a instanceof Promise?a.then(S=>S===$?f:S):a===$?f:a},l=T(u.delayInit?f:d());return l.onMount=a=>{let S;if(u.subscribe&&(S=u.subscribe(i,a),a(d())),u.delayInit){const h=d();h instanceof Promise?h.then(a):a(h)}return S},T(a=>a(l),(a,S,h)=>{const M=typeof h=="function"?h(a(l)):h;return M===Dt?(S(l,f),u.removeItem(i)):(S(l,M),u.setItem(i,M))})}export{It as a,Ot as b,xt as s,Vt as u};
