import{r,aq as T,aj as j,ah as C,g as N,j as c}from"./index.884ef809.js";import{u as H}from"./utils.71c85371.js";import{p}from"./index.a719180e.js";import{u as O,m as W,N as K}from"./useRuntimeStylesheet.cce38e2c.js";import{f as P}from"./dateConfig.7f97a25b.js";import{g as F,t as X,f as q}from"./eventsManager.fbf10d53.js";import"./index.esm.36fc65dd.js";import"./useFullscreen.e5cbfcf7.js";import"./index.641207f5.js";const $={debug:10,info:20,warn:30,error:40,none:100},D=({logLevel:z="info",maxFontSize:h=100,minFontSize:a=20,onFinish:d,onStart:o,resolution:v=5}={})=>{const M=$[z],l=r.exports.useCallback(()=>({calcKey:0,fontSize:h,fontSizePrev:a,fontSizeMax:h,fontSizeMin:a}),[h,a]),s=r.exports.useRef(null),w=r.exports.useRef(),u=r.exports.useRef(!1),[k,x]=r.exports.useState(l),{calcKey:n,fontSize:t,fontSizeMax:m,fontSizeMin:f,fontSizePrev:i}=k;let e=null;const[y]=r.exports.useState(()=>new ResizeObserver(()=>{e=window.requestAnimationFrame(()=>{u.current||(o&&o(),u.current=!0,x({...l(),calcKey:n+1}))})}));r.exports.useEffect(()=>(s.current&&y.observe(s.current),()=>{e&&window.cancelAnimationFrame(e),y.disconnect()}),[e,y]);const S=s.current&&s.current.innerHTML;return r.exports.useEffect(()=>{n===0||u.current||(S!==w.current&&(o&&o(),x({...l(),calcKey:n+1})),w.current=S)},[n,l,S,o]),r.exports.useLayoutEffect(()=>{if(n===0)return;const A=Math.abs(t-i)<=v,g=!!s.current&&(s.current.scrollHeight>s.current.offsetHeight||s.current.scrollWidth>s.current.offsetWidth),I=g&&t===i,E=t>i;if(A){I?(u.current=!1,M<=$.info&&console.info(`[use-fit-text] reached \`minFontSize = ${a}\` without fitting text`)):g?x({fontSize:E?i:f,fontSizeMax:m,fontSizeMin:f,fontSizePrev:i,calcKey:n}):(u.current=!1,d&&d(t));return}let b,L=m,R=f;g?(b=E?i-t:f-t,L=Math.min(m,t)):(b=E?m-t:i-t,R=Math.max(f,t)),x({calcKey:n,fontSize:t+b/2,fontSizeMax:L,fontSizeMin:R,fontSizePrev:t})},[n,t,m,f,i,d,s,v]),{fontSize:`${t}%`,ref:s}},V=D;const _={showSeconds:!1,format:"hh:mm"};function G(z){const{title:h,time:a,backstageEvents:d,selectedId:o,nextId:v,onAir:M,viewSettings:l}=z;O((l==null?void 0:l.overrideStyles)&&T);const{fontSize:s,ref:w}=V({maxFontSize:500}),[u,k]=r.exports.useState([]),[x]=H(W),n=[...Array(12).keys()],t=[...Array(60).keys()],m=10;r.exports.useEffect(()=>{document.title="ontime - Studio Clock"},[]),r.exports.useEffect(()=>{if(d==null)return;const y=F(d).filter(g=>g.type==="event"),S=X(y,o,m),A=q(S,o,v,{showEnd:!1});k(A)},[d,v,o]);const f=j(a.clock,_),[,,i]=C(a.clock).split(":");return N("div",{className:`studio-clock ${x?"mirror":""}`,children:[c(K,{}),N("div",{className:"clock-container",children:[c("div",{className:"studio-timer",children:f}),c("div",{ref:w,className:"next-title",style:{fontSize:s,height:"10vh",width:"100%",maxWidth:"82%"},children:h.titleNext}),c("div",{className:a.isNegative?"next-countdown":"next-countdown next-countdown--overtime",children:o!=null&&P(a.running)}),N("div",{className:"clock-indicators",children:[n.map(e=>c("div",{className:"hours hours--active",style:{transform:`rotate(${360/12*e-90}deg) translateX(40vh)`}},e)),t.map(e=>c("div",{className:e<=i?"min min--active":"min",style:{transform:`rotate(${360/60*e-90}deg) translateX(43vh)`}},e))]})]}),N("div",{className:"schedule-container",children:[c("div",{className:M?"onAir":"onAir onAir--idle",children:"ON AIR"}),c("div",{className:"schedule",children:c("ul",{children:u.map(e=>c("li",{className:e.isNow?"now":e.isNext?"next":"",style:{borderLeft:`4px solid ${e.colour!==""?e.colour:"transparent"}`},children:`${e.time} ${e.title}`},e.id))})})]})]})}G.propTypes={title:p.exports.object,time:p.exports.object,backstageEvents:p.exports.array,selectedId:p.exports.string,nextId:p.exports.string,onAir:p.exports.bool,viewSettings:p.exports.object};export{G as default};
