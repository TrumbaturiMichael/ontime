import{r as u,g as v,j as o,A as I,m as c,at as k,aq as V,ar as $}from"./index.884ef809.js";import{N as z,u as j}from"./useRuntimeStylesheet.cce38e2c.js";import{p as L}from"./index.a719180e.js";import"./index.esm.36fc65dd.js";import"./useFullscreen.e5cbfcf7.js";import"./index.641207f5.js";import"./utils.71c85371.js";function Y(d){const{lower:e,title:a,options:t}=d,s={size:1,transitionIn:3,textColour:"#fffffa",posX:50,posY:700},[r,n]=u.exports.useState(!0);u.exports.useEffect(()=>{if(!t.fadeOut)return;const f=(parseInt(t.fadeOut,10)+(t.transitionIn||s.transitionIn))*1e3;if(isNaN(f))return;const b=setTimeout(()=>{n(!1)},f);return()=>clearTimeout(b)},[t.fadeOut,t.transitionIn,s.transitionIn]);const m=e.text!==""&&e.visible,i=t.transitionIn||s.transitionIn,w=i/4,N=i/3,l=i/2,h={hidden:{opacity:0},visible:{opacity:1,transition:{duration:N}},exit:{opacity:0,transition:{duration:N}}},p={hidden:{opacity:0},visible:{opacity:1,transition:{delay:w,duration:l}}},x=(t.size||1)*4;return v("div",{className:"lower-third clean",style:{backgroundColor:t.keyColour||s.keyColour,color:t.textColour||s.textColour,fontSize:`${x}vh`},children:[o(z,{isHidden:!0}),o(I,{children:r&&v(c.div,{className:"lower-container",style:{backgroundColor:t.bgColour||s.bgColour,top:t.posY||s.posY,left:t.posX||s.posX},variants:h,initial:"hidden",animate:"visible",exit:"exit",children:[o(c.div,{className:"title",variants:p,children:a.titleNow}),o(c.div,{className:"subtitle",variants:p,children:a.presenterNow})]})}),o(I,{children:m&&o(c.div,{className:"message-container",style:{backgroundColor:t.bgColour||s.bgColour},initial:{opacity:0},animate:{opacity:1},exit:{scaleY:0,opacity:0},transition:{duration:.5},children:o("div",{className:"message",children:e.text})},"modal")})]})}function S(d){const{lower:e,title:a,options:t}=d,s={size:1,transitionIn:3,textColour:"#fffffa",bgColour:"#00000033"},[r,n]=u.exports.useState(!0);u.exports.useEffect(()=>{if(!t.fadeOut)return;const y=(parseInt(t.fadeOut,10)+(t.transitionIn||s.transitionIn))*1e3;if(isNaN(y))return;const T=setTimeout(()=>{n(!1)},y);return()=>clearTimeout(T)},[t.fadeOut,t.transitionIn,s.transitionIn]),u.exports.useEffect(()=>{n(a.showNow)},[a.showNow]);const m=e.text!==""&&e.visible,i=t.transitionIn||s.transitionIn,w=i/8,N=i/4,l=i/3,h=i/2,p={hidden:{opacity:0},visible:{opacity:1,transition:{duration:l}},exit:{opacity:0,x:-1e3,transition:{duration:l}}},x={hidden:{left:-1e3},visible:{left:0,transition:{duration:l}}},f={hidden:{opacity:0},visible:{opacity:1,transition:{delay:N,duration:h}}},b={hidden:{left:-1e3},visible:{left:0,transition:{delay:w,duration:l}}},g={hidden:{opacity:0},visible:{opacity:1,transition:{delay:l,duration:l*2}}},C=(t.size||1)*4;return v("div",{className:"lower-third lines",style:{backgroundColor:t.keyColour||s.keyColour,color:t.textColour||s.textColour,fontSize:`${C}vh`},children:[o(z,{isHidden:!0}),o(I,{children:r&&v(c.div,{className:"lower-container",style:{backgroundColor:t.bgColour||s.bgColour},variants:p,initial:"hidden",animate:"visible",exit:"exit",children:[v(c.div,{className:"title-container",variants:x,children:[o(c.div,{className:"title",variants:f,children:a.titleNow}),o("div",{className:"title-decor"})]}),v(c.div,{className:"subtitle-container",variants:b,children:[o("div",{className:"sub-decor"}),o(c.div,{className:"subtitle",variants:g,children:a.presenterNow})]})]})}),o(I,{children:m&&o(c.div,{className:"message-container",initial:{opacity:0},animate:{opacity:1},exit:{scaleY:0,opacity:0},transition:{duration:.5},children:o("div",{className:"message",children:e.text})},"modal")})]})}const q=(d,e)=>k(d.title,e.title)&&k(d.lower,e.lower),O=d=>{const{title:e,lower:a,viewSettings:t}=d,{shouldRender:s}=j((t==null?void 0:t.overrideStyles)&&V),[r]=$(),[n,m]=u.exports.useState({titleNow:"",titleNext:"",subtitleNow:"",subtitleNext:"",presenterNow:"",presenterNext:"",showNow:!1,showNext:!1});if(u.exports.useEffect(()=>{document.title="ontime - Lower Thirds"},[]),u.exports.useEffect(()=>{let y=null;return((e==null?void 0:e.titleNow)!==(n==null?void 0:n.titleNow)||(e==null?void 0:e.subtitleNow)!==(n==null?void 0:n.subtitleNow)||(e==null?void 0:e.presenterNow)!==(n==null?void 0:n.presenterNow))&&(m(E=>({...E,showNow:!1})),y=setTimeout(()=>{m(e)},2e3)),()=>{y!=null&&clearTimeout(y)}},[e.titleNow,e.subtitleNow,e.presenterNow]),!s)return null;const i={},w=parseInt(r.get("preset"),10),N=isNaN(w)?w:1,l=r.get("size");l&&(i.size=l);const h=parseInt(r.get("transition"),10);isNaN(h)||(i.transitionIn=h);const p=r.get("text");p&&(i.textColour=`#${p}`);const x=r.get("bg");x&&(i.bgColour=`#${x}`);const f=r.get("key");f&&(i.keyColour=`#${f}`);const b=parseInt(r.get("fadeout"),10);isNaN(b)||(i.fadeOut=b);const g=parseInt(r.get("x"),10);isNaN(g)||(i.posX=g);const C=parseInt(r.get("y"),10);switch(isNaN(C)||(i.posY=C),N){case 0:return o(Y,{lower:a,title:n,options:i});case 1:return o(S,{lower:a,title:n,options:i});default:return o(S,{lower:a,title:n,options:i})}},W=u.exports.memo(O,q);O.propTypes={title:L.exports.object,lower:L.exports.object,viewSettings:L.exports.object};export{W as default};
