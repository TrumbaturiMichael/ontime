import{a as O,a3 as Q,o as W,r as s,j as f,f as Y,R as ee,b as te,a4 as ne,g as S}from"./index.884ef809.js";import{m as oe,I as se}from"./index.esm.36fc65dd.js";import{c as ae,F as re}from"./FiCheck.f3465d21.js";import{p as ie}from"./index.a719180e.js";import{g as ue,H as ce}from"./index.esm.1b6714a6.js";import{u as le}from"./index.esm.e4609593.js";var pe=(...t)=>t.filter(Boolean).join(" "),de=t=>t?!0:void 0;function b(...t){return function(a){t.some(r=>(r==null||r(a),a==null?void 0:a.defaultPrevented))}}var[fe,Be,me,xe]=ae(),[he,_e]=O({name:"PinInputContext",errorMessage:"usePinInputContext: `context` is undefined. Seems you forgot to all pin input fields within `<PinInput />`"}),$=t=>t==null?void 0:t.split("");function G(t,u){return(u==="alphanumeric"?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(t)}function ve(t={}){const{autoFocus:u,value:a,defaultValue:r,onChange:l,onComplete:c,placeholder:_="\u25CB",manageFocus:p=!0,otp:v=!1,id:m,isDisabled:d,isInvalid:D,type:g="number",mask:V}=t,U=s.exports.useId(),F=m!=null?m:`pin-input-${U}`,i=me(),[j,E]=s.exports.useState(!0),[B,M]=s.exports.useState(-1),[C,x]=le({defaultValue:$(r)||[],value:$(a),onChange:n=>l==null?void 0:l(n.join(""))});s.exports.useEffect(()=>{if(u){const n=i.first();n&&requestAnimationFrame(()=>{n.node.focus()})}},[i]);const H=s.exports.useCallback(n=>{if(!j||!p)return;const e=i.next(n,!1);e&&requestAnimationFrame(()=>{e.node.focus()})},[i,j,p]),I=s.exports.useCallback((n,e)=>{const o=[...C];o[e]=n,x(o),n!==""&&o.length===i.count()&&o.every(k=>k!=null&&k!=="")?c==null||c(o.join("")):H(e)},[C,x,H,c,i]),X=s.exports.useCallback(()=>{var n;const e=Array(i.count()).fill("");x(e);const o=i.first();(n=o==null?void 0:o.node)==null||n.focus()},[i,x]),L=s.exports.useCallback((n,e)=>{let o=e;return(n==null?void 0:n.length)>0&&(n[0]===e.charAt(0)?o=e.charAt(1):n[0]===e.charAt(1)&&(o=e.charAt(0))),o},[]);return{getInputProps:s.exports.useCallback(n=>{const{index:e,...o}=n,T=y=>{const h=y.target.value,w=C[e],A=L(w,h);if(A===""){I("",e);return}if(h.length>2){if(G(h,g)){const R=h.split("").filter((Ae,J)=>J<i.count());x(R),R.length===i.count()&&(c==null||c(R.join("")))}}else G(A,g)&&I(A,e),E(!0)},k=y=>{var h;if(y.key==="Backspace"&&p)if(y.target.value===""){const w=i.prev(e,!1);w&&(I("",e-1),(h=w.node)==null||h.focus(),E(!0))}else E(!1)},q=()=>{M(e)},z=()=>{M(-1)},Z=B===e;return{"aria-label":"Please enter your pin code",inputMode:g==="number"?"numeric":"text",type:V?"password":g==="number"?"tel":"text",...o,id:`${F}-${e}`,disabled:d,"aria-invalid":de(D),onChange:b(o.onChange,T),onKeyDown:b(o.onKeyDown,k),onFocus:b(o.onFocus,q),onBlur:b(o.onBlur,z),value:C[e]||"",autoComplete:v?"one-time-code":"off",placeholder:Z?"":_}},[i,B,L,F,d,V,D,p,c,v,_,I,x,g,C]),id:F,descendants:i,values:C,setValue:I,setValues:x,clear:X}}function Ce(t={},u=null){const{getInputProps:a}=_e(),{index:r,register:l}=xe();return a({...t,ref:oe(l,u),index:r})}function K(t){const u=Q("PinInput",t),{children:a,...r}=W(t),{descendants:l,...c}=ve(r),_=ue(a).map(p=>s.exports.cloneElement(p,{__css:u}));return f(fe,{value:l,children:f(he,{value:c,children:_})})}K.displayName="PinInput";var P=Y(function(u,a){const r=Ce(u,a);return ee.createElement(te.input,{...r,className:pe("chakra-pin-input",u.className)})});P.displayName="PinInputField";const ge="_hSeparator_bkwwu_18",Ie="_vSpan_bkwwu_26",Pe="_container_bkwwu_30",ke="_pin_bkwwu_43",ye="_pin__failed_bkwwu_44",we="_colourFade_bkwwu_1",N={hSeparator:ge,vSpan:Ie,container:Pe,pin:ke,pin__failed:ye,colourFade:we};function be({children:t}){const u=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",[a,r]=s.exports.useState(""),[l,c]=s.exports.useState(!1),{auth:_,validate:p}=s.exports.useContext(ne),v=s.exports.useCallback(()=>{p(a)||(c(!0),r(""))},[a,p]);s.exports.useEffect(()=>{document.title="ontime"},[]);const m=s.exports.useCallback(d=>{d.repeat||d.keyCode===13&&v()},[v]);return s.exports.useEffect(()=>(document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}),[m]),u||_?t:S("div",{className:N.container,children:["ontime",S(ce,{spacing:"10px",className:l?N.pin__failed:N.pin,children:[S(K,{type:"alphanumeric",size:"lg",mask:!0,autoFocus:!0,value:a,onChange:d=>{c(!1),r(d)},children:[f(P,{}),f(P,{}),f(P,{}),f(P,{})]}),f(se,{"aria-label":"Enter",size:"lg",isRound:!0,icon:f(re,{}),onClick:()=>v()})]})]})}be.propTypes={children:ie.exports.node.isRequired};export{K as P,P as a,be as b};
